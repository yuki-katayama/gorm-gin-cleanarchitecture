# Application BusinessRules

## Serviceの役割
Service はアプリケーションのドメイン層またはユースケース層に属しており、次のような役割を持っています：

* ビジネスロジックの実装：アプリケーションのコアとなるビジネスルールや処理を実装します。
* データの加工と計算：データベースや外部APIから取得したデータをビジネスロジックに基づいて加工・計算します。
* トランザクションの管理：データの整合性を保つために、トランザクションを適切に管理します。
* データアクセスの抽象化：リポジトリ層を通じてデータストレージとのインターフェースを提供し、データアクセスの詳細を抽象化します。
* サービス層は、アプリケーションのビジネスロジックを集中的に扱うため、コントローラーや他のUI部品からビジネスルールを分離して、コードの再利用性とテスト容易性を高めます。

### 使用例
Serviceの使用例：商品購入時の在庫のチェック、価格の計算、トランザクションを使った購入処理の実行など


### メモ
ドメイン層に配置するロジック
ドメイン層 は、システムのビジネスルールとポリシーの核心を形成します。ここに配置されるロジックは、通常「ドメインロジック」または「エンティティロジック」と呼ばれ、以下の特性を持ちます。

エンティティ固有のルール：エンティティ（例えば、ユーザー、商品、注文など）に固有のビジネスルールやバリデーション。これはエンティティの属性やライフサイクルに密接に関連しています。
値オブジェクトのロジック：エンティティの属性に関連する計算や比較など、不変性を持つデータの扱い。
ドメインイベント：ビジネスプロセスにおける重要なイベントの生成と処理。
集約の整合性：集約ルートを通じて保証されるデータの一貫性。
サービス層に配置するロジック
サービス層 では、複数のドメインモデルや外部のシステムを扱うビジネスロジックが実装されます。この層のロジックは、以下のような特性を持ちます。

アプリケーションのワークフロー制御：ユーザーのリクエストに基づいて、特定のビジネスプロセスを実行するロジック。
トランザクション管理：データベーストランザクションの開始と終了を管理し、複数の操作を一貫した作業単位として扱います。
ドメイン層との調整：複数のドメインエンティティやサービス間でのデータの流れと協調を制御します。
外部インフラとの連携：外部APIやサービスとの連携を行う。
実用的な例
例えば、注文システムにおいて「注文が特定の条件を満たす場合に割引を適用する」というビジネスルールがあるとします。このルールが注文エンティティの内部状態に依存している場合（例えば、注文の合計金額が一定額を超える場合に割引を適用する）、そのロジックはドメイン層（具体的には注文エンティティ内）に実装するのが適切です。一方で、注文の割引処理に関わる複数のドメインエンティティや外部サービスの調整が必要な場合は、サービス層でこの処理を実装することが望ましいです。

